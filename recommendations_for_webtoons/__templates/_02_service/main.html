{% extends "../base.html" %}
{% load static %}

{% block styles %}
.artwork_img {
    filter: brightness(1);
    transition: 0.3s;
}
 
.artwork_img:hover {
    filter: brightness(0.5);
}

.artwork_title {
    font-family:"KOTRA_BOLD-Bold";
}

.artwork_img {
  transition: all 0.2s linear;
}
.artwork_img:hover{
  transform: scale(1.1);
}

#contents_pack{
 z-index: 100;
}

#bg {
    position: fixed; 
    left: 0%;
    z-index:-100;
    width: 100%;        
    height: 100%;
}

#bg img {
    position:absolute; 
    z-index:-100;
    top:0; 
    left:0; 
    right:0; 
    bottom:0; 
    min-width:50%;
    min-height:50%;
}	



{% endblock %}


{% block body %}

  {% include "./_modal.html" %}

<div id='bg'>
  <img id='service_banner' width="100%" class='py-1 rounded d-block' src="{% static 'static/img/_service_img01.png' %}">
</div>

<img id='mask_banner' width="100%" class='py-1 rounded d-block' src="{% static 'static/img/msk.png' %}">

<div id='contents_pack' class='px-4'>
    {% for gen in data1 %}
    <div class='fs-4 row py-0 my-0 mt-4'>
      <div class="artwork_title col-6 text-white">
      {{gen.name}}
      </div>
    </div>
    <div class="row row-cols-12 py-0 mt-0 mb-5  artwork">
      {% for i in gen.disp_artwork %}
      <div class="col-xxl-1 col-xl-2 col-lg-3 col-md-4">
        <a><img width="99%" class='py-1 rounded d-block artwork_img' uid='{{i.r_artwork.token}}_{{i.r_artwork.uid}}' src="{{i.r_artwork.temp_thumbpath}}"></a>      </div>
      {% endfor %}
    </div>

    {% endfor %}
    
</div>
{% endblock %}

{% block scripts %}

  var ajax_url = "{% url 'rcmd:service' %}"
  

  setTimeout(function() {
    const modals = document.querySelector('#test_modal');
    var modal = bootstrap.Modal.getOrCreateInstance(modals)  
    modal.show()
  }, 250);
    

  $(document).on("click",".artwork_img",function(){
    var value = $(this).attr('uid');
    data = {'keyword' : value,
            'indicator' : 'get_aw_detail'}
    res = request_ajax(ajax_url, data)
    if (res != 'error'){
        $('#modal_detail_artwork').replaceWith(res)
    }

    const modals = document.querySelector('#modal_detail_artwork');
    var modal = bootstrap.Modal.getOrCreateInstance(modals)  
    modal.show()
  })  
      

  $('#searchbar').on("keyup", function(){
      var value = $(this).val()
      if (value.length >= 2) {
        data = {'keyword' : value,
                'indicator' : 'get_startswith'}
        res = request_ajax(ajax_url, data)
        if (res != 'error') {
          $('#search_list').replaceWith(res)
        }
      }
      
  })

  var sb = document.getElementById('service_banner');
  var mb = document.getElementById('mask_banner');

  function fadeOutOnScroll(element, element_o) {
    if (!element) {
      return;
    }
    var distanceToTop = window.pageYOffset + element.getBoundingClientRect().top;
    var elementHeight = element.offsetHeight;
    var scrollTop = document.documentElement.scrollTop;
    
    var opacity = 1;
    if (scrollTop > distanceToTop) {
      opacity = 1 - (scrollTop) / elementHeight;
    }
    element_o.style.opacity = opacity;
  }

  function scrollHandler() {
    fadeOutOnScroll(mb, sb);
  }

  window.addEventListener('scroll', scrollHandler);


{% endblock %}